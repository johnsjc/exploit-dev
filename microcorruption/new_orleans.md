## 2. New Orleans

**Objective**: Reading MSP430 assembly

```
447e <create_password>
447e:  3f40 0024      mov	#0x2400, r15
4482:  ff40 2c00 0000 mov.b	#0x2c, 0x0(r15)
4488:  ff40 2400 0100 mov.b	#0x24, 0x1(r15)
448e:  ff40 3900 0200 mov.b	#0x39, 0x2(r15)
4494:  ff40 6400 0300 mov.b	#0x64, 0x3(r15)
449a:  ff40 7600 0400 mov.b	#0x76, 0x4(r15)
44a0:  ff40 6500 0500 mov.b	#0x65, 0x5(r15)
44a6:  ff40 3f00 0600 mov.b	#0x3f, 0x6(r15)
44ac:  cf43 0700      mov.b	#0x0, 0x7(r15)
```

In the highly suspicious **create_password** function, we can see that exact **bytes (mov.b)** are being moved into offsets of the register r15. This is the password being stored in memory. If we go to the memory address that is stored in r15, which is 0x2400, we can see the password.

```
44bc <check_password>
44bc:  0e43           clr	r14
44be:  0d4f           mov	r15, r13
44c0:  0d5e           add	r14, r13
44c2:  ee9d 0024      cmp.b	@r13, 0x2400(r14)
44c6:  0520           jne	#0x44d2 <check_password+0x16>
44c8:  1e53           inc	r14
44ca:  3e92           cmp	#0x8, r14
44cc:  f823           jne	#0x44be <check_password+0x2>
44ce:  1f43           mov	#0x1, r15
44d0:  3041           ret
44d2:  0f43           clr	r15
44d4:  3041           ret
```

In the **check_password** function, the r14 register is first set to zero. This will be our loop counter. The register r15 contains 0x439c, which is an address on the stack where the first character of our inputted password lives.

The contents of r15 do not change during the loop. A helper register, r13 also holds this same value. r14 is added to r13 to get an offset into our string. The byte comparison happens at 0x44c2. If the character does not match, the jump is immediately taken and the function ends with r15 being cleared. Otherwise, it keeps comparing characters until r14 is 0x8, indicating the password is 8 bytes in length. If the characters all match, and the length is 8, r15 is set to 1, and the function returns.

Just like in the first challenge, r15 must be nonzero for the door to be unlocked.

**Flag:** **,$9dve?**
